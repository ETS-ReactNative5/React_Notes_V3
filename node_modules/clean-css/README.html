<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 align="center">
<br/> <img src="https://cdn.rawgit.com/jakubpawlowicz/clean-css/master/logo.v2.svg" alt="clean-css logo" width="525px"/> <br/> <br/>
</h1>
<p><a href="https://www.npmjs.com/package/clean-css"><img src="https://img.shields.io/npm/v/clean-css.svg?style=flat" alt="NPM version" /></a> <a href="https://travis-ci.org/jakubpawlowicz/clean-css"><img src="https://img.shields.io/travis/jakubpawlowicz/clean-css/master.svg?style=flat&amp;label=Linux%20build" alt="Linux Build Status" /></a> <a href="https://ci.appveyor.com/project/jakubpawlowicz/clean-css/branch/master"><img src="https://img.shields.io/appveyor/ci/jakubpawlowicz/clean-css/master.svg?style=flat&amp;label=Windows%20build" alt="Windows Build status" /></a> <a href="https://david-dm.org/jakubpawlowicz/clean-css"><img src="https://img.shields.io/david/jakubpawlowicz/clean-css.svg?style=flat" alt="Dependency Status" /></a> <a href="https://npmcharts.com/compare/clean-css?minimal=true"><img src="https://img.shields.io/npm/dm/clean-css.svg" alt="NPM Downloads" /></a> <a href="https://twitter.com/cleancss"><img src="https://img.shields.io/badge/Twitter-@cleancss-blue.svg" alt="Twitter" /></a></p>
<p>clean-css is a fast and efficient CSS optimizer for <a href="http://nodejs.org/">Node.js</a> platform and <a href="https://jakubpawlowicz.github.io/clean-css">any modern browser</a>.</p>
<p>According to <a href="http://goalsmashers.github.io/css-minification-benchmark/">tests</a> it is one of the best available.</p>
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#nodejs-version-support">Node.js version support</a></li>
<li><a href="#install">Install</a></li>
<li><a href="#use">Use</a>
<ul>
<li><a href="#important-40-breaking-changes">Important: 4.0 breaking changes</a></li>
<li><a href="#whats-new-in-version-41">What’s new in version 4.1</a></li>
<li><a href="#whats-new-in-version-42">What’s new in version 4.2</a></li>
<li><a href="#constructor-options">Constructor options</a></li>
<li><a href="#compatibility-modes">Compatibility modes</a></li>
<li><a href="#fetch-option">Fetch option</a></li>
<li><a href="#formatting-options">Formatting options</a></li>
<li><a href="#inlining-options">Inlining options</a></li>
<li><a href="#optimization-levels">Optimization levels</a>
<ul>
<li><a href="#level-0-optimizations">Level 0 optimizations</a></li>
<li><a href="#level-1-optimizations">Level 1 optimizations</a></li>
<li><a href="#level-2-optimizations">Level 2 optimizations</a></li>
</ul></li>
<li><a href="#minify-method">Minify method</a></li>
<li><a href="#promise-interface">Promise interface</a></li>
<li><a href="#cli-utility">CLI utility</a></li>
</ul></li>
<li><a href="#faq">FAQ</a>
<ul>
<li><a href="#how-to-optimize-multiple-files">How to optimize multiple files?</a></li>
<li><a href="#how-to-process-remote-imports-correctly">How to process remote <code>@import</code>s correctly?</a></li>
<li><a href="#how-to-apply-arbitrary-transformations-to-css-properties">How to apply arbitrary transformations to CSS properties?</a></li>
<li><a href="#how-to-specify-a-custom-rounding-precision">How to specify a custom rounding precision?</a></li>
<li><a href="#how-to-keep-a-css-fragment-intact">How to keep a CSS fragment intact?</a></li>
<li><a href="#how-to-preserve-a-comment-block">How to preserve a comment block?</a></li>
<li><a href="#how-to-rebase-relative-image-urls">How to rebase relative image URLs?</a></li>
<li><a href="#how-to-work-with-source-maps">How to work with source maps?</a></li>
<li><a href="#how-to-apply-level-1--2-optimizations-at-the-same-time">How to apply level 1 &amp; 2 optimizations at the same time?</a></li>
<li><a href="#what-level-2-optimizations-do">What level 2 optimizations do?</a></li>
<li><a href="#how-to-use-clean-css-with-build-tools">How to use clean-css with build tools?</a></li>
<li><a href="#how-to-use-clean-css-from-web-browser">How to use clean-css from web browser?</a></li>
</ul></li>
<li><a href="#contributing">Contributing</a>
<ul>
<li><a href="#how-to-get-started">How to get started?</a></li>
</ul></li>
<li><a href="#acknowledgments">Acknowledgments</a></li>
<li><a href="#license">License</a></li>
</ul>
<h1 id="node.js-version-support">Node.js version support</h1>
<p>clean-css requires Node.js 4.0+ (tested on Linux, OS X, and Windows)</p>
<h1 id="install">Install</h1>
<pre><code>npm install --save-dev clean-css</code></pre>
<h1 id="use">Use</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> CleanCSS <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;clean-css&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">var</span> input <span class="op">=</span> <span class="st">&#39;a{font-weight:bold;}&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">var</span> options <span class="op">=</span> <span class="op">{</span> <span class="co">/* options */</span> <span class="op">};</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">var</span> output <span class="op">=</span> <span class="kw">new</span> <span class="at">CleanCSS</span>(options).<span class="at">minify</span>(input)<span class="op">;</span></a></code></pre></div>
<h2 id="important-4.0-breaking-changes">Important: 4.0 breaking changes</h2>
<p>clean-css 4.0 introduces some breaking changes:</p>
<ul>
<li>API and CLI interfaces are split, so API stays in this repository while CLI moves to <a href="https://github.com/jakubpawlowicz/clean-css-cli">clean-css-cli</a>;</li>
<li><code>root</code>, <code>relativeTo</code>, and <code>target</code> options are replaced by a single <code>rebaseTo</code> option - this means that rebasing URLs and import inlining is much simpler but may not be (YMMV) as powerful as in 3.x;</li>
<li><code>debug</code> option is gone as stats are always provided in output object under <code>stats</code> property;</li>
<li><code>roundingPrecision</code> is disabled by default;</li>
<li><code>roundingPrecision</code> applies to <strong>all</strong> units now, not only <code>px</code> as in 3.x;</li>
<li><code>processImport</code> and <code>processImportFrom</code> are merged into <code>inline</code> option which defaults to <code>local</code>. Remote <code>@import</code> rules are <strong>NOT</strong> inlined by default anymore;</li>
<li>splits <code>inliner: { request: ..., timeout: ... }</code> option into <code>inlineRequest</code> and <code>inlineTimeout</code> options;</li>
<li>remote resources without a protocol, e.g. <code>//fonts.googleapis.com/css?family=Domine:700</code>, are not inlined anymore;</li>
<li>changes default Internet Explorer compatibility from 9+ to 10+, to revert the old default use <code>{ compatibility: 'ie9' }</code> flag;</li>
<li>renames <code>keepSpecialComments</code> to <code>specialComments</code>;</li>
<li>moves <code>roundingPrecision</code> and <code>specialComments</code> to level 1 optimizations options, see examples;</li>
<li>moves <code>mediaMerging</code>, <code>restructuring</code>, <code>semanticMerging</code>, and <code>shorthandCompacting</code> to level 2 optimizations options, see examples below;</li>
<li>renames <code>shorthandCompacting</code> option to <code>mergeIntoShorthands</code>;</li>
<li>level 1 optimizations are the new default, up to 3.x it was level 2;</li>
<li><code>keepBreaks</code> option is replaced with <code>{ format: 'keep-breaks' }</code> to ease transition;</li>
<li><code>sourceMap</code> option has to be a boolean from now on - to specify an input source map pass it a 2nd argument to <code>minify</code> method or via a hash instead;</li>
<li><code>aggressiveMerging</code> option is removed as aggressive merging is replaced by smarter override merging.</li>
</ul>
<h2 id="whats-new-in-version-4.1">What’s new in version 4.1</h2>
<p>clean-css 4.1 introduces the following changes / features:</p>
<ul>
<li><code>inline: false</code> as an alias to <code>inline: ['none']</code>;</li>
<li><code>multiplePseudoMerging</code> compatibility flag controlling merging of rules with multiple pseudo classes / elements;</li>
<li><code>removeEmpty</code> flag in level 1 optimizations controlling removal of rules and nested blocks;</li>
<li><code>removeEmpty</code> flag in level 2 optimizations controlling removal of rules and nested blocks;</li>
<li><code>compatibility: { selectors: { mergeLimit: &lt;number&gt; } }</code> flag in compatibility settings controlling maximum number of selectors in a single rule;</li>
<li><code>minify</code> method improved signature accepting a list of hashes for a predictable traversal;</li>
<li><code>selectorsSortingMethod</code> level 1 optimization allows <code>false</code> or <code>'none'</code> for disabling selector sorting;</li>
<li><code>fetch</code> option controlling a function for handling remote requests;</li>
<li>new <code>font</code> shorthand and <code>font-*</code> longhand optimizers;</li>
<li>removal of <code>optimizeFont</code> flag in level 1 optimizations due to new <code>font</code> shorthand optimizer;</li>
<li><code>skipProperties</code> flag in level 2 optimizations controlling which properties won’t be optimized;</li>
<li>new <code>animation</code> shorthand and <code>animation-*</code> longhand optimizers;</li>
<li><code>removeUnusedAtRules</code> level 2 optimization controlling removal of unused <code>@counter-style</code>, <code>@font-face</code>, <code>@keyframes</code>, and <code>@namespace</code> at rules;</li>
<li>the <a href="https://jakubpawlowicz.github.io/clean-css">web interface</a> gets an improved settings panel with “reset to defaults”, instant option changes, and settings being persisted across sessions.</li>
</ul>
<h2 id="whats-new-in-version-4.2">What’s new in version 4.2</h2>
<p>clean-css 4.2 introduces the following changes / features:</p>
<ul>
<li>Adds <code>process</code> method for compatibility with optimize-css-assets-webpack-plugin;</li>
<li>new <code>transition</code> property optimizer;</li>
<li>preserves any CSS content between <code>/* clean-css ignore:start */</code> and <code>/* clean-css ignore:end */</code> comments;</li>
<li>allows filtering based on selector in <code>transform</code> callback, see <a href="#how-to-apply-arbitrary-transformations-to-css-properties">example</a>;</li>
<li>adds configurable line breaks via <code>format: { breakWith: 'lf' }</code> option.</li>
</ul>
<h2 id="constructor-options">Constructor options</h2>
<p>clean-css constructor accepts a hash as a parameter with the following options available:</p>
<ul>
<li><code>compatibility</code> - controls compatibility mode used; defaults to <code>ie10+</code>; see <a href="#compatibility-modes">compatibility modes</a> for examples;</li>
<li><code>fetch</code> - controls a function for handling remote requests; see <a href="#fetch-option">fetch option</a> for examples (since 4.1.0);</li>
<li><code>format</code> - controls output CSS formatting; defaults to <code>false</code>; see <a href="#formatting-options">formatting options</a> for examples;</li>
<li><code>inline</code> - controls <code>@import</code> inlining rules; defaults to <code>'local'</code>; see <a href="#inlining-options">inlining options</a> for examples;</li>
<li><code>inlineRequest</code> - controls extra options for inlining remote <code>@import</code> rules, can be any of <a href="https://nodejs.org/api/http.html#http_http_request_options_callback">HTTP(S) request options</a>;</li>
<li><code>inlineTimeout</code> - controls number of milliseconds after which inlining a remote <code>@import</code> fails; defaults to 5000;</li>
<li><code>level</code> - controls optimization level used; defaults to <code>1</code>; see <a href="#optimization-levels">optimization levels</a> for examples;</li>
<li><code>rebase</code> - controls URL rebasing; defaults to <code>true</code>;</li>
<li><code>rebaseTo</code> - controls a directory to which all URLs are rebased, most likely the directory under which the output file will live; defaults to the current directory;</li>
<li><code>returnPromise</code> - controls whether <code>minify</code> method returns a Promise object or not; defaults to <code>false</code>; see <a href="#promise-interface">promise interface</a> for examples;</li>
<li><code>sourceMap</code> - controls whether an output source map is built; defaults to <code>false</code>;</li>
<li><code>sourceMapInlineSources</code> - controls embedding sources inside a source map’s <code>sourcesContent</code> field; defaults to false.</li>
</ul>
<h2 id="compatibility-modes">Compatibility modes</h2>
<p>There is a certain number of compatibility mode shortcuts, namely:</p>
<ul>
<li><code>new CleanCSS({ compatibility: '*' })</code> (default) - Internet Explorer 10+ compatibility mode</li>
<li><code>new CleanCSS({ compatibility: 'ie9' })</code> - Internet Explorer 9+ compatibility mode</li>
<li><code>new CleanCSS({ compatibility: 'ie8' })</code> - Internet Explorer 8+ compatibility mode</li>
<li><code>new CleanCSS({ compatibility: 'ie7' })</code> - Internet Explorer 7+ compatibility mode</li>
</ul>
<p>Each of these modes is an alias to a <a href="https://github.com/jakubpawlowicz/clean-css/blob/master/lib/options/compatibility.js">fine grained configuration</a>, with the following options available:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="dt">compatibility</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="dt">colors</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">      <span class="dt">opacity</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// controls `rgba()` / `hsla()` color support</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="dt">properties</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="dt">backgroundClipMerging</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls background-clip merging into shorthand</span></a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="dt">backgroundOriginMerging</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls background-origin merging into shorthand</span></a>
<a class="sourceLine" id="cb3-9" title="9">      <span class="dt">backgroundSizeMerging</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls background-size merging into shorthand</span></a>
<a class="sourceLine" id="cb3-10" title="10">      <span class="dt">colors</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls color optimizations</span></a>
<a class="sourceLine" id="cb3-11" title="11">      <span class="dt">ieBangHack</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls keeping IE bang hack</span></a>
<a class="sourceLine" id="cb3-12" title="12">      <span class="dt">ieFilters</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls keeping IE `filter` / `-ms-filter`</span></a>
<a class="sourceLine" id="cb3-13" title="13">      <span class="dt">iePrefixHack</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls keeping IE prefix hack</span></a>
<a class="sourceLine" id="cb3-14" title="14">      <span class="dt">ieSuffixHack</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls keeping IE suffix hack</span></a>
<a class="sourceLine" id="cb3-15" title="15">      <span class="dt">merging</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls property merging based on understandability</span></a>
<a class="sourceLine" id="cb3-16" title="16">      <span class="dt">shorterLengthUnits</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls shortening pixel units into `pc`, `pt`, or `in` units</span></a>
<a class="sourceLine" id="cb3-17" title="17">      <span class="dt">spaceAfterClosingBrace</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls keeping space after closing brace - `url() no-repeat` into `url()no-repeat`</span></a>
<a class="sourceLine" id="cb3-18" title="18">      <span class="dt">urlQuotes</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls keeping quoting inside `url()`</span></a>
<a class="sourceLine" id="cb3-19" title="19">      <span class="dt">zeroUnits</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// controls removal of units `0` value</span></a>
<a class="sourceLine" id="cb3-20" title="20">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-21" title="21">    <span class="dt">selectors</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-22" title="22">      <span class="dt">adjacentSpace</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls extra space before `nav` element</span></a>
<a class="sourceLine" id="cb3-23" title="23">      <span class="dt">ie7Hack</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls removal of IE7 selector hacks, e.g. `*+html...`</span></a>
<a class="sourceLine" id="cb3-24" title="24">      <span class="dt">mergeablePseudoClasses</span><span class="op">:</span> [<span class="st">&#39;:active&#39;</span><span class="op">,</span> ...]<span class="op">,</span> <span class="co">// controls a whitelist of mergeable pseudo classes</span></a>
<a class="sourceLine" id="cb3-25" title="25">      <span class="dt">mergeablePseudoElements</span><span class="op">:</span> [<span class="st">&#39;::after&#39;</span><span class="op">,</span> ...]<span class="op">,</span> <span class="co">// controls a whitelist of mergeable pseudo elements</span></a>
<a class="sourceLine" id="cb3-26" title="26">      <span class="dt">mergeLimit</span><span class="op">:</span> <span class="dv">8191</span><span class="op">,</span> <span class="co">// controls maximum number of selectors in a single rule (since 4.1.0)</span></a>
<a class="sourceLine" id="cb3-27" title="27">      <span class="dt">multiplePseudoMerging</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// controls merging of rules with multiple pseudo classes / elements (since 4.1.0)</span></a>
<a class="sourceLine" id="cb3-28" title="28">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-29" title="29">    <span class="dt">units</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-30" title="30">      <span class="dt">ch</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `ch` as a supported unit</span></a>
<a class="sourceLine" id="cb3-31" title="31">      <span class="kw">in</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `in` as a supported unit</span></a>
<a class="sourceLine" id="cb3-32" title="32">      <span class="dt">pc</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `pc` as a supported unit</span></a>
<a class="sourceLine" id="cb3-33" title="33">      <span class="dt">pt</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `pt` as a supported unit</span></a>
<a class="sourceLine" id="cb3-34" title="34">      <span class="dt">rem</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `rem` as a supported unit</span></a>
<a class="sourceLine" id="cb3-35" title="35">      <span class="dt">vh</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `vh` as a supported unit</span></a>
<a class="sourceLine" id="cb3-36" title="36">      <span class="dt">vm</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `vm` as a supported unit</span></a>
<a class="sourceLine" id="cb3-37" title="37">      <span class="dt">vmax</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls treating `vmax` as a supported unit</span></a>
<a class="sourceLine" id="cb3-38" title="38">      <span class="dt">vmin</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// controls treating `vmin` as a supported unit</span></a>
<a class="sourceLine" id="cb3-39" title="39">    <span class="op">}</span></a>
<a class="sourceLine" id="cb3-40" title="40">  <span class="op">}</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="op">}</span>)</a></code></pre></div>
<p>You can also use a string when setting a compatibility mode, e.g.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">compatibility</span><span class="op">:</span> <span class="st">&#39;ie9,-properties.merging&#39;</span> <span class="co">// sets compatibility to IE9 mode with disabled property merging</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<h2 id="fetch-option">Fetch option</h2>
<p>The <code>fetch</code> option accepts a function which handles remote resource fetching, e.g.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span> request <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;request&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">var</span> source <span class="op">=</span> <span class="st">&#39;@import url(http://example.com/path/to/stylesheet.css);&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">fetch</span><span class="op">:</span> <span class="kw">function</span> (uri<span class="op">,</span> inlineRequest<span class="op">,</span> inlineTimeout<span class="op">,</span> callback) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="at">request</span>(uri<span class="op">,</span> <span class="kw">function</span> (error<span class="op">,</span> response<span class="op">,</span> body) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-6" title="6">      <span class="cf">if</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-7" title="7">        <span class="at">callback</span>(error<span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-8" title="8">      <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> (response <span class="op">&amp;&amp;</span> <span class="va">response</span>.<span class="at">statusCode</span> <span class="op">!=</span> <span class="dv">200</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-9" title="9">        <span class="at">callback</span>(<span class="va">response</span>.<span class="at">statusCode</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-10" title="10">      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-11" title="11">        <span class="at">callback</span>(<span class="kw">null</span><span class="op">,</span> body)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-12" title="12">      <span class="op">}</span></a>
<a class="sourceLine" id="cb5-13" title="13">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-14" title="14">  <span class="op">}</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="op">}</span>).<span class="at">minify</span>(source)<span class="op">;</span></a></code></pre></div>
<p>This option provides a convenient way of overriding the default fetching logic if it doesn’t support a particular feature, say CONNECT proxies.</p>
<p>Unless given, the default <a href="https://github.com/jakubpawlowicz/clean-css/blob/master/lib/reader/load-remote-resource.js">loadRemoteResource</a> logic is used.</p>
<h2 id="formatting-options">Formatting options</h2>
<p>By default output CSS is formatted without any whitespace unless a <code>format</code> option is given. First of all there are two shorthands:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;beautify&#39;</span> <span class="co">// formats output in a really nice way</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;keep-breaks&#39;</span> <span class="co">// formats output the default way but adds line breaks for improved readability</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<p>however <code>format</code> option also accept a fine-grained set of options:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="dt">format</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="dt">breaks</span><span class="op">:</span> <span class="op">{</span> <span class="co">// controls where to insert breaks</span></a>
<a class="sourceLine" id="cb8-4" title="4">      <span class="dt">afterAtRule</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after an at-rule; e.g. `@charset`; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-5" title="5">      <span class="dt">afterBlockBegins</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after a block begins; e.g. `@media`; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-6" title="6">      <span class="dt">afterBlockEnds</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after a block ends, defaults to `false`</span></a>
<a class="sourceLine" id="cb8-7" title="7">      <span class="dt">afterComment</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after a comment; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-8" title="8">      <span class="dt">afterProperty</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after a property; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-9" title="9">      <span class="dt">afterRuleBegins</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after a rule begins; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-10" title="10">      <span class="dt">afterRuleEnds</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes after a rule ends; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-11" title="11">      <span class="dt">beforeBlockEnds</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a line break comes before a block ends; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-12" title="12">      <span class="dt">betweenSelectors</span><span class="op">:</span> <span class="kw">false</span> <span class="co">// controls if a line break comes between selectors; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-13" title="13">    <span class="op">},</span></a>
<a class="sourceLine" id="cb8-14" title="14">    <span class="dt">breakWith</span><span class="op">:</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span><span class="op">,</span> <span class="co">// controls the new line character, can be `&#39;\r\n&#39;` or `&#39;\n&#39;` (aliased as `&#39;windows&#39;` and `&#39;unix&#39;` or `&#39;crlf&#39;` and `&#39;lf&#39;`); defaults to system one, so former on Windows and latter on Unix</span></a>
<a class="sourceLine" id="cb8-15" title="15">    <span class="dt">indentBy</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="co">// controls number of characters to indent with; defaults to `0`</span></a>
<a class="sourceLine" id="cb8-16" title="16">    <span class="dt">indentWith</span><span class="op">:</span> <span class="st">&#39;space&#39;</span><span class="op">,</span> <span class="co">// controls a character to indent with, can be `&#39;space&#39;` or `&#39;tab&#39;`; defaults to `&#39;space&#39;`</span></a>
<a class="sourceLine" id="cb8-17" title="17">    <span class="dt">spaces</span><span class="op">:</span> <span class="op">{</span> <span class="co">// controls where to insert spaces</span></a>
<a class="sourceLine" id="cb8-18" title="18">      <span class="dt">aroundSelectorRelation</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if spaces come around selector relations; e.g. `div &gt; a`; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-19" title="19">      <span class="dt">beforeBlockBegins</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls if a space comes before a block begins; e.g. `.block {`; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-20" title="20">      <span class="dt">beforeValue</span><span class="op">:</span> <span class="kw">false</span> <span class="co">// controls if a space comes before a value; e.g. `width: 1rem`; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-21" title="21">    <span class="op">},</span></a>
<a class="sourceLine" id="cb8-22" title="22">    <span class="dt">wrapAt</span><span class="op">:</span> <span class="kw">false</span> <span class="co">// controls maximum line length; defaults to `false`</span></a>
<a class="sourceLine" id="cb8-23" title="23">  <span class="op">}</span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="op">}</span>)</a></code></pre></div>
<h2 id="inlining-options">Inlining options</h2>
<p><code>inline</code> option whitelists which <code>@import</code> rules will be processed, e.g.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">inline</span><span class="op">:</span> [<span class="st">&#39;local&#39;</span>] <span class="co">// default; enables local inlining only</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="dt">inline</span><span class="op">:</span> [<span class="st">&#39;none&#39;</span>] <span class="co">// disables all inlining</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="co">// introduced in clean-css 4.1.0</span></a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="dt">inline</span><span class="op">:</span> <span class="kw">false</span> <span class="co">// disables all inlining (alias to `[&#39;none&#39;]`)</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="dt">inline</span><span class="op">:</span> [<span class="st">&#39;all&#39;</span>] <span class="co">// enables all inlining, same as [&#39;local&#39;, &#39;remote&#39;]</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">inline</span><span class="op">:</span> [<span class="st">&#39;local&#39;</span><span class="op">,</span> <span class="st">&#39;mydomain.example.com&#39;</span>] <span class="co">// enables local inlining plus given remote source</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="dt">inline</span><span class="op">:</span> [<span class="st">&#39;local&#39;</span><span class="op">,</span> <span class="st">&#39;remote&#39;</span><span class="op">,</span> <span class="st">&#39;!fonts.googleapis.com&#39;</span>] <span class="co">// enables all inlining but from given remote source</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<h2 id="optimization-levels">Optimization levels</h2>
<p>The <code>level</code> option can be either <code>0</code>, <code>1</code> (default), or <code>2</code>, e.g.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<p>or a fine-grained configuration given via a hash.</p>
<p>Please note that level 1 optimization options are generally safe while level 2 optimizations should be safe for most users.</p>
<h3 id="level-0-optimizations">Level 0 optimizations</h3>
<p>Level 0 optimizations simply means “no optimizations”. Use it when you’d like to inline imports and / or rebase URLs but skip everything else.</p>
<h3 id="level-1-optimizations">Level 1 optimizations</h3>
<p>Level 1 optimizations (default) operate on single properties only, e.g. can remove units when not required, turn rgb colors to a shorter hex representation, remove comments, etc</p>
<p>Here is a full list of available options:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-3" title="3">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-4" title="4">      <span class="dt">cleanupCharsets</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `@charset` moving to the front of a stylesheet; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-5" title="5">      <span class="dt">normalizeUrls</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls URL normalization; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-6" title="6">      <span class="dt">optimizeBackground</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `background` property optimizations; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-7" title="7">      <span class="dt">optimizeBorderRadius</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `border-radius` property optimizations; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-8" title="8">      <span class="dt">optimizeFilter</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `filter` property optimizations; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-9" title="9">      <span class="dt">optimizeFont</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `font` property optimizations; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-10" title="10">      <span class="dt">optimizeFontWeight</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `font-weight` property optimizations; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-11" title="11">      <span class="dt">optimizeOutline</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `outline` property optimizations; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-12" title="12">      <span class="dt">removeEmpty</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls removing empty rules and nested blocks; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-13" title="13">      <span class="dt">removeNegativePaddings</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls removing negative paddings; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-14" title="14">      <span class="dt">removeQuotes</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls removing quotes when unnecessary; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-15" title="15">      <span class="dt">removeWhitespace</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls removing unused whitespace; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-16" title="16">      <span class="dt">replaceMultipleZeros</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// contols removing redundant zeros; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-17" title="17">      <span class="dt">replaceTimeUnits</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls replacing time units with shorter values; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-18" title="18">      <span class="dt">replaceZeroUnits</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls replacing zero values with units; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-19" title="19">      <span class="dt">roundingPrecision</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// rounds pixel values to `N` decimal places; `false` disables rounding; defaults to `false`</span></a>
<a class="sourceLine" id="cb16-20" title="20">      <span class="dt">selectorsSortingMethod</span><span class="op">:</span> <span class="st">&#39;standard&#39;</span><span class="op">,</span> <span class="co">// denotes selector sorting method; can be `&#39;natural&#39;` or `&#39;standard&#39;`, `&#39;none&#39;`, or false (the last two since 4.1.0); defaults to `&#39;standard&#39;`</span></a>
<a class="sourceLine" id="cb16-21" title="21">      <span class="dt">specialComments</span><span class="op">:</span> <span class="st">&#39;all&#39;</span><span class="op">,</span> <span class="co">// denotes a number of /*! ... */ comments preserved; defaults to `all`</span></a>
<a class="sourceLine" id="cb16-22" title="22">      <span class="dt">tidyAtRules</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls at-rules (e.g. `@charset`, `@import`) optimizing; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-23" title="23">      <span class="dt">tidyBlockScopes</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls block scopes (e.g. `@media`) optimizing; defaults to `true`</span></a>
<a class="sourceLine" id="cb16-24" title="24">      <span class="dt">tidySelectors</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls selectors optimizing; defaults to `true`,</span></a>
<a class="sourceLine" id="cb16-25" title="25">      <span class="dt">semicolonAfterLastProperty</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls removing trailing semicolons in rule; defaults to `false` - means remove</span></a>
<a class="sourceLine" id="cb16-26" title="26">      <span class="dt">transform</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{}</span> <span class="co">// defines a callback for fine-grained property optimization; defaults to no-op</span></a>
<a class="sourceLine" id="cb16-27" title="27">    <span class="op">}</span></a>
<a class="sourceLine" id="cb16-28" title="28">  <span class="op">}</span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>There is an <code>all</code> shortcut for toggling all options at the same time, e.g.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-3" title="3">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-4" title="4">      <span class="dt">all</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// set all values to `false`</span></a>
<a class="sourceLine" id="cb17-5" title="5">      <span class="dt">tidySelectors</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// turns on optimizing selectors</span></a>
<a class="sourceLine" id="cb17-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb17-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="level-2-optimizations">Level 2 optimizations</h3>
<p>Level 2 optimizations operate at rules or multiple properties level, e.g. can remove duplicate rules, remove properties redefined further down a stylesheet, or restructure rules by moving them around.</p>
<p>Please note that if level 2 optimizations are turned on then, unless explicitely disabled, level 1 optimizations are applied as well.</p>
<p>Here is a full list of available options:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-3" title="3">    <span class="dv">2</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-4" title="4">      <span class="dt">mergeAdjacentRules</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls adjacent rules merging; defaults to true</span></a>
<a class="sourceLine" id="cb18-5" title="5">      <span class="dt">mergeIntoShorthands</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls merging properties into shorthands; defaults to true</span></a>
<a class="sourceLine" id="cb18-6" title="6">      <span class="dt">mergeMedia</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls `@media` merging; defaults to true</span></a>
<a class="sourceLine" id="cb18-7" title="7">      <span class="dt">mergeNonAdjacentRules</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls non-adjacent rule merging; defaults to true</span></a>
<a class="sourceLine" id="cb18-8" title="8">      <span class="dt">mergeSemantically</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls semantic merging; defaults to false</span></a>
<a class="sourceLine" id="cb18-9" title="9">      <span class="dt">overrideProperties</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls property overriding based on understandability; defaults to true</span></a>
<a class="sourceLine" id="cb18-10" title="10">      <span class="dt">removeEmpty</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls removing empty rules and nested blocks; defaults to `true`</span></a>
<a class="sourceLine" id="cb18-11" title="11">      <span class="dt">reduceNonAdjacentRules</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls non-adjacent rule reducing; defaults to true</span></a>
<a class="sourceLine" id="cb18-12" title="12">      <span class="dt">removeDuplicateFontRules</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls duplicate `@font-face` removing; defaults to true</span></a>
<a class="sourceLine" id="cb18-13" title="13">      <span class="dt">removeDuplicateMediaBlocks</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls duplicate `@media` removing; defaults to true</span></a>
<a class="sourceLine" id="cb18-14" title="14">      <span class="dt">removeDuplicateRules</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// controls duplicate rules removing; defaults to true</span></a>
<a class="sourceLine" id="cb18-15" title="15">      <span class="dt">removeUnusedAtRules</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls unused at rule removing; defaults to false (available since 4.1.0)</span></a>
<a class="sourceLine" id="cb18-16" title="16">      <span class="dt">restructureRules</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// controls rule restructuring; defaults to false</span></a>
<a class="sourceLine" id="cb18-17" title="17">      <span class="dt">skipProperties</span><span class="op">:</span> [] <span class="co">// controls which properties won&#39;t be optimized, defaults to `[]` which means all will be optimized (since 4.1.0)</span></a>
<a class="sourceLine" id="cb18-18" title="18">    <span class="op">}</span></a>
<a class="sourceLine" id="cb18-19" title="19">  <span class="op">}</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>There is an <code>all</code> shortcut for toggling all options at the same time, e.g.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb19-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb19-3" title="3">    <span class="dv">2</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb19-4" title="4">      <span class="dt">all</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="co">// sets all values to `false`</span></a>
<a class="sourceLine" id="cb19-5" title="5">      <span class="dt">removeDuplicateRules</span><span class="op">:</span> <span class="kw">true</span> <span class="co">// turns on removing duplicate rules</span></a>
<a class="sourceLine" id="cb19-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb19-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="minify-method">Minify method</h2>
<p>Once configured clean-css provides a <code>minify</code> method to optimize a given CSS, e.g.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">var</span> output <span class="op">=</span> <span class="kw">new</span> <span class="at">CleanCSS</span>(options).<span class="at">minify</span>(source)<span class="op">;</span></a></code></pre></div>
<p>The output of the <code>minify</code> method is a hash with following fields:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="at">styles</span>)<span class="op">;</span> <span class="co">// optimized output CSS as a string</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="at">sourceMap</span>)<span class="op">;</span> <span class="co">// output source map if requested with `sourceMap` option</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="at">errors</span>)<span class="op">;</span> <span class="co">// a list of errors raised</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="at">warnings</span>)<span class="op">;</span> <span class="co">// a list of warnings raised</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="va">stats</span>.<span class="at">originalSize</span>)<span class="op">;</span> <span class="co">// original content size after import inlining</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="va">stats</span>.<span class="at">minifiedSize</span>)<span class="op">;</span> <span class="co">// optimized content size</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="va">stats</span>.<span class="at">timeSpent</span>)<span class="op">;</span> <span class="co">// time spent on optimizations in milliseconds</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="va">stats</span>.<span class="at">efficiency</span>)<span class="op">;</span> <span class="co">// `(originalSize - minifiedSize) / originalSize`, e.g. 0.25 if size is reduced from 100 bytes to 75 bytes</span></a></code></pre></div>
<p>The <code>minify</code> method also accepts an input source map, e.g.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">var</span> output <span class="op">=</span> <span class="kw">new</span> <span class="at">CleanCSS</span>(options).<span class="at">minify</span>(source<span class="op">,</span> inputSourceMap)<span class="op">;</span></a></code></pre></div>
<p>or a callback invoked when optimizations are finished, e.g.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(options).<span class="at">minify</span>(source<span class="op">,</span> <span class="kw">function</span> (error<span class="op">,</span> output) <span class="op">{</span></a>
<a class="sourceLine" id="cb23-2" title="2">  <span class="co">// `output` is the same as in the synchronous call above</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="promise-interface">Promise interface</h2>
<p>If you prefer clean-css to return a Promise object then you need to explicitely ask for it, e.g.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span> <span class="dt">returnPromise</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">  .<span class="at">minify</span>(source)</a>
<a class="sourceLine" id="cb24-3" title="3">  .<span class="at">then</span>(<span class="kw">function</span> (output) <span class="op">{</span> <span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="at">styles</span>)<span class="op">;</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb24-4" title="4">  .<span class="at">catch</span>(<span class="kw">function</span> (error) <span class="op">{</span> <span class="co">// deal with errors });</span></a></code></pre></div>
<h2 id="cli-utility">CLI utility</h2>
<p>Clean-css has an associated command line utility that can be installed separately using <code>npm install clean-css-cli</code>. For more detailed information, please visit https://github.com/jakubpawlowicz/clean-css-cli.</p>
<h1 id="faq">FAQ</h1>
<h2 id="how-to-optimize-multiple-files">How to optimize multiple files?</h2>
<p>It can be done either by passing an array of paths, or, when sources are already available, a hash or an array of hashes:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>().<span class="at">minify</span>([<span class="st">&#39;path/to/file/one&#39;</span><span class="op">,</span> <span class="st">&#39;path/to/file/two&#39;</span>])<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>().<span class="at">minify</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb26-2" title="2">  <span class="st">&#39;path/to/file/one&#39;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-3" title="3">    <span class="dt">styles</span><span class="op">:</span> <span class="st">&#39;contents of file one&#39;</span></a>
<a class="sourceLine" id="cb26-4" title="4">  <span class="op">},</span></a>
<a class="sourceLine" id="cb26-5" title="5">  <span class="st">&#39;path/to/file/two&#39;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-6" title="6">    <span class="dt">styles</span><span class="op">:</span> <span class="st">&#39;contents of file two&#39;</span></a>
<a class="sourceLine" id="cb26-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>().<span class="at">minify</span>([</a>
<a class="sourceLine" id="cb27-2" title="2">  <span class="op">{</span><span class="st">&#39;path/to/file/one&#39;</span><span class="op">:</span> <span class="op">{</span><span class="dt">styles</span><span class="op">:</span> <span class="st">&#39;contents of file one&#39;</span><span class="op">}},</span></a>
<a class="sourceLine" id="cb27-3" title="3">  <span class="op">{</span><span class="st">&#39;path/to/file/two&#39;</span><span class="op">:</span> <span class="op">{</span><span class="dt">styles</span><span class="op">:</span> <span class="st">&#39;contents of file two&#39;</span><span class="op">}}</span></a>
<a class="sourceLine" id="cb27-4" title="4">])<span class="op">;</span></a></code></pre></div>
<p>Passing an array of hashes allows you to explicitly specify the order in which the input files are concatenated. Whereas when you use a single hash the order is determined by the <a href="http://2ality.com/2015/10/property-traversal-order-es6.html">traversal order of object properties</a> - available since 4.1.0.</p>
<p>Important note - any <code>@import</code> rules already present in the hash will be resolved in memory.</p>
<h2 id="how-to-process-remote-imports-correctly">How to process remote <code>@import</code>s correctly?</h2>
<p>In order to inline remote <code>@import</code> statements you need to provide a callback to minify method as fetching remote assets is an asynchronous operation, e.g.:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">var</span> source <span class="op">=</span> <span class="st">&#39;@import url(http://example.com/path/to/remote/styles);&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span> <span class="dt">inline</span><span class="op">:</span> [<span class="st">&#39;remote&#39;</span>] <span class="op">}</span>).<span class="at">minify</span>(source<span class="op">,</span> <span class="kw">function</span> (error<span class="op">,</span> output) <span class="op">{</span></a>
<a class="sourceLine" id="cb28-3" title="3">  <span class="co">// output.styles</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If you don’t provide a callback, then remote <code>@import</code>s will be left as is.</p>
<h2 id="how-to-apply-arbitrary-transformations-to-css-properties">How to apply arbitrary transformations to CSS properties?</h2>
<p>If clean-css doesn’t perform a particular property optimization, you can use <code>transform</code> callback to apply it:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">var</span> source <span class="op">=</span> <span class="st">&#39;.block{background-image:url(/path/to/image.png)}&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">var</span> output <span class="op">=</span> <span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb29-3" title="3">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb29-4" title="4">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb29-5" title="5">      <span class="dt">transform</span><span class="op">:</span> <span class="kw">function</span> (propertyName<span class="op">,</span> propertyValue<span class="op">,</span> selector <span class="co">/* `selector` available since 4.2.0-pre */</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb29-6" title="6">        <span class="cf">if</span> (propertyName <span class="op">==</span> <span class="st">&#39;background-image&#39;</span> <span class="op">&amp;&amp;</span> <span class="va">propertyValue</span>.<span class="at">indexOf</span>(<span class="st">&#39;/path/to&#39;</span>) <span class="op">&gt;</span> <span class="dv">-1</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb29-7" title="7">          <span class="cf">return</span> <span class="va">propertyValue</span>.<span class="at">replace</span>(<span class="st">&#39;/path/to&#39;</span><span class="op">,</span> <span class="st">&#39;../valid/path/to&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb29-8" title="8">        <span class="op">}</span></a>
<a class="sourceLine" id="cb29-9" title="9">      <span class="op">}</span></a>
<a class="sourceLine" id="cb29-10" title="10">    <span class="op">}</span></a>
<a class="sourceLine" id="cb29-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="op">}</span>).<span class="at">minify</span>(source)<span class="op">;</span></a>
<a class="sourceLine" id="cb29-13" title="13"></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="va">console</span>.<span class="at">log</span>(<span class="va">output</span>.<span class="at">styles</span>)<span class="op">;</span> # <span class="kw">=&gt;</span> .<span class="at">block</span><span class="op">{</span>background<span class="op">-</span><span class="dt">image</span><span class="op">:</span><span class="at">url</span>(../valid/path/to/<span class="va">image</span>.<span class="at">png</span>)<span class="op">}</span></a></code></pre></div>
<p>Note: returning <code>false</code> from <code>transform</code> callback will drop a property.</p>
<h2 id="how-to-specify-a-custom-rounding-precision">How to specify a custom rounding precision?</h2>
<p>The level 1 <code>roundingPrecision</code> optimization option accept a string with per-unit rounding precision settings, e.g.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb30-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-3" title="3">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-4" title="4">      <span class="dt">roundingPrecision</span><span class="op">:</span> <span class="st">&#39;all=3,px=5&#39;</span></a>
<a class="sourceLine" id="cb30-5" title="5">    <span class="op">}</span></a>
<a class="sourceLine" id="cb30-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="op">}</span>).<span class="at">minify</span>(source)</a></code></pre></div>
<p>which sets all units rounding precision to 3 digits except <code>px</code> unit precision of 5 digits.</p>
<h2 id="how-to-keep-a-css-fragment-intact">How to keep a CSS fragment intact?</h2>
<p>Note: available in the current master, to be released in 4.2.0.</p>
<p>Wrap the CSS fragment in special comments which instruct clean-css to preserve it, e.g.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb31-1" title="1"><span class="fu">.block-1</span> {</a>
<a class="sourceLine" id="cb31-2" title="2">  <span class="kw">color</span>: <span class="cn">red</span></a>
<a class="sourceLine" id="cb31-3" title="3">}</a>
<a class="sourceLine" id="cb31-4" title="4"><span class="co">/* clean-css ignore:start */</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="fu">.block-special</span> {</a>
<a class="sourceLine" id="cb31-6" title="6">  <span class="kw">color</span>: <span class="dv">transparent</span></a>
<a class="sourceLine" id="cb31-7" title="7">}</a>
<a class="sourceLine" id="cb31-8" title="8"><span class="co">/* clean-css ignore:end */</span></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="fu">.block-2</span> {</a>
<a class="sourceLine" id="cb31-10" title="10">  <span class="kw">margin</span>: <span class="dv">0</span></a>
<a class="sourceLine" id="cb31-11" title="11">}</a></code></pre></div>
<p>Optimizing this CSS will result in the following output:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb32-1" title="1"><span class="fu">.block-1</span>{<span class="kw">color</span>:<span class="cn">red</span>}</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="fu">.block-special</span> {</a>
<a class="sourceLine" id="cb32-3" title="3">  <span class="kw">color</span>: <span class="dv">transparent</span></a>
<a class="sourceLine" id="cb32-4" title="4">}</a>
<a class="sourceLine" id="cb32-5" title="5"><span class="fu">.block-2</span>{<span class="kw">margin</span>:<span class="dv">0</span>}</a></code></pre></div>
<h2 id="how-to-preserve-a-comment-block">How to preserve a comment block?</h2>
<p>Use the <code>/*!</code> notation instead of the standard one <code>/*</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb33-1" title="1"><span class="co">/*!</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co">  Important comments included in optimized output.</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co">*/</span></a></code></pre></div>
<h2 id="how-to-rebase-relative-image-urls">How to rebase relative image URLs?</h2>
<p>clean-css will handle it automatically for you in the following cases:</p>
<ul>
<li>when full paths to input files are passed in as options;</li>
<li>when correct paths are passed in via a hash;</li>
<li>when <code>rebaseTo</code> is used with any of above two.</li>
</ul>
<h2 id="how-to-work-with-source-maps">How to work with source maps?</h2>
<p>To generate a source map, use <code>sourceMap: true</code> option, e.g.:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span> <span class="dt">sourceMap</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">rebaseTo</span><span class="op">:</span> pathToOutputDirectory <span class="op">}</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">  .<span class="at">minify</span>(source<span class="op">,</span> <span class="kw">function</span> (error<span class="op">,</span> output) <span class="op">{</span></a>
<a class="sourceLine" id="cb34-3" title="3">    <span class="co">// access output.sourceMap for SourceMapGenerator object</span></a>
<a class="sourceLine" id="cb34-4" title="4">    <span class="co">// see https://github.com/mozilla/source-map/#sourcemapgenerator for more details</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>You can also pass an input source map directly as a 2nd argument to <code>minify</code> method:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span> <span class="dt">sourceMap</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">rebaseTo</span><span class="op">:</span> pathToOutputDirectory <span class="op">}</span>)</a>
<a class="sourceLine" id="cb35-2" title="2">  .<span class="at">minify</span>(source<span class="op">,</span> inputSourceMap<span class="op">,</span> <span class="kw">function</span> (error<span class="op">,</span> output) <span class="op">{</span></a>
<a class="sourceLine" id="cb35-3" title="3">    <span class="co">// access output.sourceMap to access SourceMapGenerator object</span></a>
<a class="sourceLine" id="cb35-4" title="4">    <span class="co">// see https://github.com/mozilla/source-map/#sourcemapgenerator for more details</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>or even multiple input source maps at once:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span> <span class="dt">sourceMap</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">rebaseTo</span><span class="op">:</span> pathToOutputDirectory <span class="op">}</span>).<span class="at">minify</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb36-2" title="2">  <span class="st">&#39;path/to/source/1&#39;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb36-3" title="3">    <span class="dt">styles</span><span class="op">:</span> <span class="st">&#39;...styles...&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb36-4" title="4">    <span class="dt">sourceMap</span><span class="op">:</span> <span class="st">&#39;...source-map...&#39;</span></a>
<a class="sourceLine" id="cb36-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb36-6" title="6">  <span class="st">&#39;path/to/source/2&#39;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb36-7" title="7">    <span class="dt">styles</span><span class="op">:</span> <span class="st">&#39;...styles...&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb36-8" title="8">    <span class="dt">sourceMap</span><span class="op">:</span> <span class="st">&#39;...source-map...&#39;</span></a>
<a class="sourceLine" id="cb36-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="op">},</span> <span class="kw">function</span> (error<span class="op">,</span> output) <span class="op">{</span></a>
<a class="sourceLine" id="cb36-11" title="11">  <span class="co">// access output.sourceMap as above</span></a>
<a class="sourceLine" id="cb36-12" title="12"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="how-to-apply-level-1-2-optimizations-at-the-same-time">How to apply level 1 &amp; 2 optimizations at the same time?</h2>
<p>Using the hash configuration specifying both optimization levels, e.g.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">new</span> <span class="at">CleanCSS</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb37-2" title="2">  <span class="dt">level</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb37-3" title="3">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb37-4" title="4">      <span class="dt">all</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb37-5" title="5">      <span class="dt">normalizeUrls</span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb37-6" title="6">    <span class="op">},</span></a>
<a class="sourceLine" id="cb37-7" title="7">    <span class="dv">2</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb37-8" title="8">      <span class="dt">restructureRules</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb37-9" title="9">    <span class="op">}</span></a>
<a class="sourceLine" id="cb37-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb37-11" title="11"><span class="op">}</span>)</a></code></pre></div>
<p>will apply level 1 optimizations, except url normalization, and default level 2 optimizations with rule restructuring.</p>
<h2 id="what-level-2-optimizations-do">What level 2 optimizations do?</h2>
<p>All level 2 optimizations are dispatched <a href="https://github.com/jakubpawlowicz/clean-css/blob/master/lib/optimizer/level-2/optimize.js#L67">here</a>, and this is what they do:</p>
<ul>
<li><code>recursivelyOptimizeBlocks</code> - does all the following operations on a nested block, like <code>@media</code> or <code>@keyframe</code>;</li>
<li><code>recursivelyOptimizeProperties</code> - optimizes properties in rulesets and flat at-rules, like <span class="citation" data-cites="font-face">@font-face</span>, by splitting them into components (e.g. <code>margin</code> into <code>margin-(bottom|left|right|top)</code>), optimizing, and restoring them back. You may want to use <code>mergeIntoShorthands</code> option to control whether you want to turn multiple components into shorthands;</li>
<li><code>removeDuplicates</code> - gets rid of duplicate rulesets with exactly the same set of properties, e.g. when including a Sass / Less partial twice for no good reason;</li>
<li><code>mergeAdjacent</code> - merges adjacent rulesets with the same selector or rules;</li>
<li><code>reduceNonAdjacent</code> - identifies which properties are overridden in same-selector non-adjacent rulesets, and removes them;</li>
<li><code>mergeNonAdjacentBySelector</code> - identifies same-selector non-adjacent rulesets which can be moved (!) to be merged, requires all intermediate rulesets to not redefine the moved properties, or if redefined to have the same value;</li>
<li><code>mergeNonAdjacentByBody</code> - same as the one above but for same-selector non-adjacent rulesets;</li>
<li><code>restructure</code> - tries to reorganize different-selector different-rules rulesets so they take less space, e.g. <code>.one{padding:0}.two{margin:0}.one{margin-bottom:3px}</code> into <code>.two{margin:0}.one{padding:0;margin-bottom:3px}</code>;</li>
<li><code>removeDuplicateFontAtRules</code> - removes duplicated <code>@font-face</code> rules;</li>
<li><code>removeDuplicateMediaQueries</code> - removes duplicated <code>@media</code> nested blocks;</li>
<li><code>mergeMediaQueries</code> - merges non-adjacent <code>@media</code> at-rules by the same rules as <code>mergeNonAdjacentBy*</code> above;</li>
</ul>
<h2 id="how-to-use-clean-css-with-build-tools">How to use clean-css with build tools?</h2>
<p>There is a number of 3rd party plugins to popular build tools:</p>
<ul>
<li><a href="https://github.com/broccolijs/broccoli#broccoli">Broccoli</a>: <a href="https://github.com/shinnn/broccoli-clean-css">broccoli-clean-css</a></li>
<li><a href="http://brunch.io/">Brunch</a>: <a href="https://github.com/brunch/clean-css-brunch">clean-css-brunch</a></li>
<li><a href="http://gruntjs.com">Grunt</a>: <a href="https://github.com/gruntjs/grunt-contrib-cssmin">grunt-contrib-cssmin</a></li>
<li><a href="http://gulpjs.com/">Gulp</a>: <a href="https://github.com/scniro/gulp-clean-css">gulp-clean-css</a></li>
<li><a href="http://gulpjs.com/">Gulp</a>: <span class="citation" data-cites="sogko">[using vinyl-map as a wrapper - courtesy of @sogko]</span>(https://github.com/jakubpawlowicz/clean-css/issues/342)</li>
<li><a href="https://github.com/component/builder2.js">component-builder2</a>: <a href="https://github.com/poying/builder-clean-css">builder-clean-css</a></li>
<li><a href="http://metalsmith.io">Metalsmith</a>: <a href="https://github.com/aymericbeaumet/metalsmith-clean-css">metalsmith-clean-css</a></li>
<li><a href="https://github.com/lasso-js/lasso">Lasso</a>: <a href="https://github.com/yomed/lasso-clean-css">lasso-clean-css</a></li>
<li><a href="https://github.com/start-runner/start">Start</a>: <a href="https://github.com/start-runner/clean-css">start-clean-css</a></li>
</ul>
<h2 id="how-to-use-clean-css-from-web-browser">How to use clean-css from web browser?</h2>
<ul>
<li>https://jakubpawlowicz.github.io/clean-css/ (official web interface)</li>
<li>http://refresh-sf.com/</li>
<li>http://adamburgess.github.io/clean-css-online/</li>
</ul>
<h1 id="contributing">Contributing</h1>
<p>See <a href="https://github.com/jakubpawlowicz/clean-css/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a>.</p>
<h2 id="how-to-get-started">How to get started?</h2>
<p>First clone the sources:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb38-1" title="1"><span class="fu">git</span> clone git@github.com:jakubpawlowicz/clean-css.git</a></code></pre></div>
<p>then install dependencies:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb39-1" title="1"><span class="bu">cd</span> clean-css</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="ex">npm</span> install</a></code></pre></div>
<p>then use any of the following commands to verify your copy:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb40-1" title="1"><span class="ex">npm</span> run bench <span class="co"># for clean-css benchmarks (see [test/bench.js](https://github.com/jakubpawlowicz/clean-css/blob/master/test/bench.js) for details)</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="ex">npm</span> run browserify <span class="co"># to create the browser-ready clean-css version</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="ex">npm</span> run check <span class="co"># to lint JS sources with [JSHint](https://github.com/jshint/jshint/)</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="ex">npm</span> test <span class="co"># to run all tests</span></a></code></pre></div>
<h1 id="acknowledgments">Acknowledgments</h1>
<p>Sorted alphabetically by GitHub handle:</p>
<ul>
<li><span class="citation" data-cites="abarre">[@abarre]</span>(https://github.com/abarre) (Anthony Barre) for improvements to <code>@import</code> processing;</li>
<li><span class="citation" data-cites="alexlamsl">[@alexlamsl]</span>(https://github.com/alexlamsl) (Alex Lam S.L.) for testing early clean-css 4 versions, reporting bugs, and suggesting numerous improvements.</li>
<li><span class="citation" data-cites="altschuler">[@altschuler]</span>(https://github.com/altschuler) (Simon Altschuler) for fixing <code>@import</code> processing inside comments;</li>
<li><span class="citation" data-cites="ben-eb">[@ben-eb]</span>(https://github.com/ben-eb) (Ben Briggs) for sharing ideas about CSS optimizations;</li>
<li><span class="citation" data-cites="davisjam">[@davisjam]</span>(https://github.com/davisjam) (Jamie Davis) for disclosing ReDOS vulnerabilities;</li>
<li><span class="citation" data-cites="facelessuser">[@facelessuser]</span>(https://github.com/facelessuser) (Isaac) for pointing out a flaw in clean-css’ stateless mode;</li>
<li><span class="citation" data-cites="grandrath">[@grandrath]</span>(https://github.com/grandrath) (Martin Grandrath) for improving <code>minify</code> method source traversal in ES6;</li>
<li><span class="citation" data-cites="jmalonzo">[@jmalonzo]</span>(https://github.com/jmalonzo) (Jan Michael Alonzo) for a patch removing node.js’ old <code>sys</code> package;</li>
<li><span class="citation" data-cites="lukeapage">[@lukeapage]</span>(https://github.com/lukeapage) (Luke Page) for suggestions and testing the source maps feature; Plus everyone else involved in <a href="https://github.com/jakubpawlowicz/clean-css/issues/125">#125</a> for pushing it forward;</li>
<li><span class="citation" data-cites="madwizard-thomas">[@madwizard-thomas]</span>(https://github.com/madwizard-thomas) for sharing ideas about <code>@import</code> inlining and URL rebasing.</li>
<li><span class="citation" data-cites="ngyikp">[@ngyikp]</span>(https://github.com/ngyikp) (Ng Yik Phang) for testing early clean-css 4 versions, reporting bugs, and suggesting numerous improvements.</li>
<li><span class="citation" data-cites="wagenet">[@wagenet]</span>(https://github.com/wagenet) (Peter Wagenet) for suggesting improvements to <code>@import</code> inlining behavior;</li>
<li><span class="citation" data-cites="venemo">[@venemo]</span>(https://github.com/venemo) (Timur Kristóf) for an outstanding contribution of advanced property optimizer for 2.2 release;</li>
<li><span class="citation" data-cites="vvo">[@vvo]</span>(https://github.com/vvo) (Vincent Voyer) for a patch with better empty element regex and for inspiring us to do many performance improvements in 0.4 release;</li>
<li><span class="citation" data-cites="xhmikosr">[@xhmikosr]</span>(https://github.com/xhmikosr) for suggesting new features, like option to remove special comments and strip out URLs quotation, and pointing out numerous improvements like JSHint, media queries, etc.</li>
</ul>
<h1 id="license">License</h1>
<p>clean-css is released under the <a href="https://github.com/jakubpawlowicz/clean-css/blob/master/LICENSE">MIT License</a>.</p>
</body>
</html>
