<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="section"><img src="./logo.png" alt="bn.js" width="160" height="160" /></h1>
<blockquote>
<p>BigNum in pure javascript</p>
</blockquote>
<p><a href="http://travis-ci.org/indutny/bn.js"><img src="https://secure.travis-ci.org/indutny/bn.js.png" alt="Build Status" /></a></p>
<h2 id="install">Install</h2>
<p><code>npm install --save bn.js</code></p>
<h2 id="usage">Usage</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> BN <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;bn.js&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">var</span> a <span class="op">=</span> <span class="kw">new</span> <span class="at">BN</span>(<span class="st">&#39;dead&#39;</span><span class="op">,</span> <span class="dv">16</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">var</span> b <span class="op">=</span> <span class="kw">new</span> <span class="at">BN</span>(<span class="st">&#39;101010&#39;</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">var</span> res <span class="op">=</span> <span class="va">a</span>.<span class="at">add</span>(b)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="va">console</span>.<span class="at">log</span>(<span class="va">res</span>.<span class="at">toString</span>(<span class="dv">10</span>))<span class="op">;</span>  <span class="co">// 57047</span></a></code></pre></div>
<p><strong>Note</strong>: decimals are not supported in this library.</p>
<h2 id="notation">Notation</h2>
<h3 id="prefixes">Prefixes</h3>
<p>There are several prefixes to instructions that affect the way the work. Here is the list of them in the order of appearance in the function name:</p>
<ul>
<li><code>i</code> - perform operation in-place, storing the result in the host object (on which the method was invoked). Might be used to avoid number allocation costs</li>
<li><code>u</code> - unsigned, ignore the sign of operands when performing operation, or always return positive value. Second case applies to reduction operations like <code>mod()</code>. In such cases if the result will be negative - modulo will be added to the result to make it positive</li>
</ul>
<h3 id="postfixes">Postfixes</h3>
<p>The only available postfix at the moment is:</p>
<ul>
<li><code>n</code> - which means that the argument of the function must be a plain JavaScript Number. Decimals are not supported.</li>
</ul>
<h3 id="examples">Examples</h3>
<ul>
<li><code>a.iadd(b)</code> - perform addition on <code>a</code> and <code>b</code>, storing the result in <code>a</code></li>
<li><code>a.umod(b)</code> - reduce <code>a</code> modulo <code>b</code>, returning positive value</li>
<li><code>a.iushln(13)</code> - shift bits of <code>a</code> left by 13</li>
</ul>
<h2 id="instructions">Instructions</h2>
<p>Prefixes/postfixes are put in parens at the of the line. <code>endian</code> - could be either <code>le</code> (little-endian) or <code>be</code> (big-endian).</p>
<h3 id="utilities">Utilities</h3>
<ul>
<li><code>a.clone()</code> - clone number</li>
<li><code>a.toString(base, length)</code> - convert to base-string and pad with zeroes</li>
<li><code>a.toNumber()</code> - convert to Javascript Number (limited to 53 bits)</li>
<li><code>a.toJSON()</code> - convert to JSON compatible hex string (alias of <code>toString(16)</code>)</li>
<li><code>a.toArray(endian, length)</code> - convert to byte <code>Array</code>, and optionally zero pad to length, throwing if already exceeding</li>
<li><code>a.toArrayLike(type, endian, length)</code> - convert to an instance of <code>type</code>, which must behave like an <code>Array</code></li>
<li><code>a.toBuffer(endian, length)</code> - convert to Node.js Buffer (if available). For compatibility with browserify and similar tools, use this instead: <code>a.toArrayLike(Buffer, endian, length)</code></li>
<li><code>a.bitLength()</code> - get number of bits occupied</li>
<li><code>a.zeroBits()</code> - return number of less-significant consequent zero bits (example: <code>1010000</code> has 4 zero bits)</li>
<li><code>a.byteLength()</code> - return number of bytes occupied</li>
<li><code>a.isNeg()</code> - true if the number is negative</li>
<li><code>a.isEven()</code> - no comments</li>
<li><code>a.isOdd()</code> - no comments</li>
<li><code>a.isZero()</code> - no comments</li>
<li><code>a.cmp(b)</code> - compare numbers and return <code>-1</code> (a <code>&lt;</code> b), <code>0</code> (a <code>==</code> b), or <code>1</code> (a <code>&gt;</code> b) depending on the comparison result (<code>ucmp</code>, <code>cmpn</code>)</li>
<li><code>a.lt(b)</code> - <code>a</code> less than <code>b</code> (<code>n</code>)</li>
<li><code>a.lte(b)</code> - <code>a</code> less than or equals <code>b</code> (<code>n</code>)</li>
<li><code>a.gt(b)</code> - <code>a</code> greater than <code>b</code> (<code>n</code>)</li>
<li><code>a.gte(b)</code> - <code>a</code> greater than or equals <code>b</code> (<code>n</code>)</li>
<li><code>a.eq(b)</code> - <code>a</code> equals <code>b</code> (<code>n</code>)</li>
<li><code>a.toTwos(width)</code> - convert to two’s complement representation, where <code>width</code> is bit width</li>
<li><code>a.fromTwos(width)</code> - convert from two’s complement representation, where <code>width</code> is the bit width</li>
<li><code>BN.isBN(object)</code> - returns true if the supplied <code>object</code> is a BN.js instance</li>
</ul>
<h3 id="arithmetics">Arithmetics</h3>
<ul>
<li><code>a.neg()</code> - negate sign (<code>i</code>)</li>
<li><code>a.abs()</code> - absolute value (<code>i</code>)</li>
<li><code>a.add(b)</code> - addition (<code>i</code>, <code>n</code>, <code>in</code>)</li>
<li><code>a.sub(b)</code> - subtraction (<code>i</code>, <code>n</code>, <code>in</code>)</li>
<li><code>a.mul(b)</code> - multiply (<code>i</code>, <code>n</code>, <code>in</code>)</li>
<li><code>a.sqr()</code> - square (<code>i</code>)</li>
<li><code>a.pow(b)</code> - raise <code>a</code> to the power of <code>b</code></li>
<li><code>a.div(b)</code> - divide (<code>divn</code>, <code>idivn</code>)</li>
<li><code>a.mod(b)</code> - reduct (<code>u</code>, <code>n</code>) (but no <code>umodn</code>)</li>
<li><code>a.divRound(b)</code> - rounded division</li>
</ul>
<h3 id="bit-operations">Bit operations</h3>
<ul>
<li><code>a.or(b)</code> - or (<code>i</code>, <code>u</code>, <code>iu</code>)</li>
<li><code>a.and(b)</code> - and (<code>i</code>, <code>u</code>, <code>iu</code>, <code>andln</code>) (NOTE: <code>andln</code> is going to be replaced with <code>andn</code> in future)</li>
<li><code>a.xor(b)</code> - xor (<code>i</code>, <code>u</code>, <code>iu</code>)</li>
<li><code>a.setn(b)</code> - set specified bit to <code>1</code></li>
<li><code>a.shln(b)</code> - shift left (<code>i</code>, <code>u</code>, <code>iu</code>)</li>
<li><code>a.shrn(b)</code> - shift right (<code>i</code>, <code>u</code>, <code>iu</code>)</li>
<li><code>a.testn(b)</code> - test if specified bit is set</li>
<li><code>a.maskn(b)</code> - clear bits with indexes higher or equal to <code>b</code> (<code>i</code>)</li>
<li><code>a.bincn(b)</code> - add <code>1 &lt;&lt; b</code> to the number</li>
<li><code>a.notn(w)</code> - not (for the width specified by <code>w</code>) (<code>i</code>)</li>
</ul>
<h3 id="reduction">Reduction</h3>
<ul>
<li><code>a.gcd(b)</code> - GCD</li>
<li><code>a.egcd(b)</code> - Extended GCD results (<code>{ a: ..., b: ..., gcd: ... }</code>)</li>
<li><code>a.invm(b)</code> - inverse <code>a</code> modulo <code>b</code></li>
</ul>
<h2 id="fast-reduction">Fast reduction</h2>
<p>When doing lots of reductions using the same modulo, it might be beneficial to use some tricks: like <a href="https://en.wikipedia.org/wiki/Montgomery_modular_multiplication">Montgomery multiplication</a>, or using special algorithm for <a href="https://en.wikipedia.org/wiki/Mersenne_prime">Mersenne Prime</a>.</p>
<h3 id="reduction-context">Reduction context</h3>
<p>To enable this tricks one should create a reduction context:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> red <span class="op">=</span> <span class="va">BN</span>.<span class="at">red</span>(num)<span class="op">;</span></a></code></pre></div>
<p>where <code>num</code> is just a BN instance.</p>
<p>Or:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">var</span> red <span class="op">=</span> <span class="va">BN</span>.<span class="at">red</span>(primeName)<span class="op">;</span></a></code></pre></div>
<p>Where <code>primeName</code> is either of these <a href="https://en.wikipedia.org/wiki/Mersenne_prime">Mersenne Primes</a>:</p>
<ul>
<li><code>'k256'</code></li>
<li><code>'p224'</code></li>
<li><code>'p192'</code></li>
<li><code>'p25519'</code></li>
</ul>
<p>Or:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> red <span class="op">=</span> <span class="va">BN</span>.<span class="at">mont</span>(num)<span class="op">;</span></a></code></pre></div>
<p>To reduce numbers with <a href="https://en.wikipedia.org/wiki/Montgomery_modular_multiplication">Montgomery trick</a>. <code>.mont()</code> is generally faster than <code>.red(num)</code>, but slower than <code>BN.red(primeName)</code>.</p>
<h3 id="converting-numbers">Converting numbers</h3>
<p>Before performing anything in reduction context - numbers should be converted to it. Usually, this means that one should:</p>
<ul>
<li>Convert inputs to reducted ones</li>
<li>Operate on them in reduction context</li>
<li>Convert outputs back from the reduction context</li>
</ul>
<p>Here is how one may convert numbers to <code>red</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span> redA <span class="op">=</span> <span class="va">a</span>.<span class="at">toRed</span>(red)<span class="op">;</span></a></code></pre></div>
<p>Where <code>red</code> is a reduction context created using instructions above</p>
<p>Here is how to convert them back:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">var</span> a <span class="op">=</span> <span class="va">redA</span>.<span class="at">fromRed</span>()<span class="op">;</span></a></code></pre></div>
<h3 id="red-instructions">Red instructions</h3>
<p>Most of the instructions from the very start of this readme have their counterparts in red context:</p>
<ul>
<li><code>a.redAdd(b)</code>, <code>a.redIAdd(b)</code></li>
<li><code>a.redSub(b)</code>, <code>a.redISub(b)</code></li>
<li><code>a.redShl(num)</code></li>
<li><code>a.redMul(b)</code>, <code>a.redIMul(b)</code></li>
<li><code>a.redSqr()</code>, <code>a.redISqr()</code></li>
<li><code>a.redSqrt()</code> - square root modulo reduction context’s prime</li>
<li><code>a.redInvm()</code> - modular inverse of the number</li>
<li><code>a.redNeg()</code></li>
<li><code>a.redPow(b)</code> - modular exponentiation</li>
</ul>
<h2 id="license">LICENSE</h2>
<p>This software is licensed under the MIT License.</p>
</body>
</html>
