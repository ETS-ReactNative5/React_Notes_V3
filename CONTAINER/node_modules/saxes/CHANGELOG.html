<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CHANGELOG</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<p><a name="3.1.11"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.10...v3.1.11">3.1.11</a> (2019-06-25)</p>
<h3 id="bug-fixes">Bug Fixes</h3>
<ul>
<li>pay attention to comments and processing instructions in DTDs (<a href="https://github.com/lddubeau/saxes/commit/52ffd90">52ffd90</a>), closes <a href="https://github.com/lddubeau/saxes/issues/19">#19</a></li>
</ul>
<h3 id="performance-improvements">Performance Improvements</h3>
<ul>
<li>check the most common case first (<a href="https://github.com/lddubeau/saxes/commit/40a34d5">40a34d5</a>)</li>
<li>improve some more the speed of ]]&gt; detection (<a href="https://github.com/lddubeau/saxes/commit/a0216cd">a0216cd</a>)</li>
<li>move more common/valid cases first (<a href="https://github.com/lddubeau/saxes/commit/a65586e">a65586e</a>)</li>
<li>split sText into two specialized loops (<a href="https://github.com/lddubeau/saxes/commit/732325e">732325e</a>)</li>
<li>use specialized code for sAttribValueQuoted (<a href="https://github.com/lddubeau/saxes/commit/6c484f3">6c484f3</a>)</li>
</ul>
<p><a name="3.1.10"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.9...v3.1.10">3.1.10</a> (2019-06-11)</p>
<h3 id="performance-improvements-1">Performance Improvements</h3>
<ul>
<li>improve the check for ]]&gt; in character data (<a href="https://github.com/lddubeau/saxes/commit/21df9b5">21df9b5</a>)</li>
</ul>
<p><a name="3.1.9"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.7...v3.1.9">3.1.9</a> (2019-02-25)</p>
<h3 id="bug-fixes-1">Bug Fixes</h3>
<ul>
<li>move eslint to devDependencies (<a href="https://github.com/lddubeau/saxes/commit/d747538">d747538</a>)</li>
</ul>
<p><a name="3.1.8"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.7...v3.1.8">3.1.8</a> (2019-02-25)</p>
<p><a name="3.1.7"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.6...v3.1.7">3.1.7</a> (2019-02-22)</p>
<h3 id="bug-fixes-2">Bug Fixes</h3>
<ul>
<li>npm audit warning (<a href="https://github.com/lddubeau/saxes/commit/a6c9ba8">a6c9ba8</a>)</li>
<li><strong>typings:</strong> “selfClosing” =&gt; “isSelfClosing” (<a href="https://github.com/lddubeau/saxes/commit/d96a2bd">d96a2bd</a>)</li>
</ul>
<p><a name="3.1.6"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.5...v3.1.6">3.1.6</a> (2019-01-17)</p>
<h3 id="bug-fixes-3">Bug Fixes</h3>
<ul>
<li>detect unclosed tags in fragments (<a href="https://github.com/lddubeau/saxes/commit/5642f36">5642f36</a>)</li>
</ul>
<p><a name="3.1.5"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.4...v3.1.5">3.1.5</a> (2019-01-08)</p>
<h3 id="bug-fixes-4">Bug Fixes</h3>
<ul>
<li>generate an error on prefix with empty local name (<a href="https://github.com/lddubeau/saxes/commit/89a3b86">89a3b86</a>), closes <a href="https://github.com/lddubeau/saxes/issues/5">#5</a></li>
</ul>
<p><a name="3.1.4"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.3...v3.1.4">3.1.4</a> (2018-12-03)</p>
<h3 id="bug-fixes-5">Bug Fixes</h3>
<ul>
<li>add fragment and additionalNamespaces to SaxesOption typing (<a href="https://github.com/lddubeau/saxes/commit/02d8275">02d8275</a>)</li>
</ul>
<p><a name="3.1.3"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.2...v3.1.3">3.1.3</a> (2018-10-01)</p>
<h3 id="bug-fixes-6">Bug Fixes</h3>
<ul>
<li>use the latest xmlchars (<a href="https://github.com/lddubeau/saxes/commit/b30a714">b30a714</a>)</li>
</ul>
<h3 id="performance-improvements-2">Performance Improvements</h3>
<ul>
<li>don’t check twice if this.textNode is set (<a href="https://github.com/lddubeau/saxes/commit/00536cc">00536cc</a>)</li>
<li>reduce the frequency at which we clear attribValue (<a href="https://github.com/lddubeau/saxes/commit/1570615">1570615</a>)</li>
</ul>
<p><a name="3.1.2"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.1...v3.1.2">3.1.2</a> (2018-08-31)</p>
<h3 id="bug-fixes-7">Bug Fixes</h3>
<ul>
<li>CDATA end in attributes must not cause an error (<a href="https://github.com/lddubeau/saxes/commit/a7495ac">a7495ac</a>)</li>
<li>normalize and </li>
</ul>
<p><a name="3.1.1"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v3.1.0...v3.1.1">3.1.1</a> (2018-08-29)</p>
<h3 id="bug-fixes-8">Bug Fixes</h3>
<ul>
<li>resolve is now part of the public API (<a href="https://github.com/lddubeau/saxes/commit/bb4bed5">bb4bed5</a>)</li>
</ul>
<p><a name="3.1.0"></a> # <a href="https://github.com/lddubeau/saxes/compare/v3.0.0...v3.1.0">3.1.0</a> (2018-08-28)</p>
<h3 id="bug-fixes-9">Bug Fixes</h3>
<ul>
<li>correct typo (<a href="https://github.com/lddubeau/saxes/commit/97bc5da">97bc5da</a>)</li>
</ul>
<h3 id="performance-improvements-3">Performance Improvements</h3>
<ul>
<li>add emitNodes to skip checking text buffer more than needed (<a href="https://github.com/lddubeau/saxes/commit/9d5e357">9d5e357</a>)</li>
<li>capture names in the <code>name</code> field (<a href="https://github.com/lddubeau/saxes/commit/c7dffd5">c7dffd5</a>)</li>
<li>introduce a specialized version of captureWhile (<a href="https://github.com/lddubeau/saxes/commit/04855d6">04855d6</a>)</li>
<li>introduce captureTo and captureToChar (<a href="https://github.com/lddubeau/saxes/commit/76eb95a">76eb95a</a>)</li>
<li>remove skipWhitespace (<a href="https://github.com/lddubeau/saxes/commit/c8b7ae2">c8b7ae2</a>)</li>
<li>remove some redundant buffer resets (<a href="https://github.com/lddubeau/saxes/commit/5ded326">5ded326</a>)</li>
<li>use charCodeAt and handle surrogates ourselves (<a href="https://github.com/lddubeau/saxes/commit/b8ec232">b8ec232</a>)</li>
</ul>
<p><a name="3.0.0"></a> # <a href="https://github.com/lddubeau/saxes/compare/v2.2.1...v3.0.0">3.0.0</a> (2018-08-21)</p>
<h3 id="features">Features</h3>
<ul>
<li>process the xmlns attribute the customary way (<a href="https://github.com/lddubeau/saxes/commit/2c9672a">2c9672a</a>)</li>
</ul>
<h3 id="breaking-changes">BREAKING CHANGES</h3>
<ul>
<li>In previous versions the attribute <code>xmlns</code> (as in <code>&lt;foo xmlns="some-uri"&gt;</code> would be reported as having the prefix <code>"xmlns"</code> and the local name <code>""</code>. This behavior was inherited from sax. There was some logic to it, but this behavior was surprising to users of the library. The principle of least surprise favors eliminating that surprising behavior in favor of something less surprising.</li>
</ul>
<p>This commit makes it so that <code>xmlns</code> is not reported as having a prefix of <code>""</code> and a local name of <code>"xmlns"</code>. This accords with how people interpret attribute names like <code>foo</code>, <code>bar</code>, <code>moo</code> which all have no prefix and a local name.</p>
<p>Code that deals with namespace bindings or cares about <code>xmlns</code> probably needs to be changed.</p>
<p><a name="2.2.1"></a> ## <a href="https://github.com/lddubeau/saxes/compare/v2.2.0...v2.2.1">2.2.1</a> (2018-08-20)</p>
<h3 id="bug-fixes-10">Bug Fixes</h3>
<ul>
<li>use <code>isNameChar</code> for later chars in PI target (<a href="https://github.com/lddubeau/saxes/commit/83d2b61">83d2b61</a>)</li>
</ul>
<p><a name="2.2.0"></a> # <a href="https://github.com/lddubeau/saxes/compare/v2.1.0...v2.2.0">2.2.0</a> (2018-08-20)</p>
<h3 id="features-1">Features</h3>
<ul>
<li>add the <code>resolvePrefix</code> option (<a href="https://github.com/lddubeau/saxes/commit/90301fb">90301fb</a>)</li>
</ul>
<p><a name="2.1.0"></a> # <a href="https://github.com/lddubeau/saxes/compare/v2.0.0...v2.1.0">2.1.0</a> (2018-08-20)</p>
<h3 id="features-2">Features</h3>
<ul>
<li>add support for parsing fragments (<a href="https://github.com/lddubeau/saxes/commit/1ff2d6a">1ff2d6a</a>)</li>
<li>stronger check on bad cdata closure (<a href="https://github.com/lddubeau/saxes/commit/d416760">d416760</a>)</li>
</ul>
<h3 id="performance-improvements-4">Performance Improvements</h3>
<ul>
<li>concatenate openWakaBang just once (<a href="https://github.com/lddubeau/saxes/commit/07345bf">07345bf</a>)</li>
<li>improve text node checking speed (<a href="https://github.com/lddubeau/saxes/commit/f270e8b">f270e8b</a>)</li>
<li>minor optimizations (<a href="https://github.com/lddubeau/saxes/commit/c7e36bf">c7e36bf</a>)</li>
<li>remove an unnecessary variable (<a href="https://github.com/lddubeau/saxes/commit/ac03a1c">ac03a1c</a>)</li>
<li>remove handler check (<a href="https://github.com/lddubeau/saxes/commit/fbe35ff">fbe35ff</a>)</li>
<li>simplify captureWhile (<a href="https://github.com/lddubeau/saxes/commit/bb2085c">bb2085c</a>)</li>
<li>simplify the skip functions (<a href="https://github.com/lddubeau/saxes/commit/c7b8c3b">c7b8c3b</a>)</li>
<li>the c field has been unused for a while: remove it (<a href="https://github.com/lddubeau/saxes/commit/9ca0246">9ca0246</a>)</li>
<li>use strings for the general states (<a href="https://github.com/lddubeau/saxes/commit/3869908">3869908</a>)</li>
</ul>
<p><a name="2.0.0"></a> # <a href="https://github.com/lddubeau/saxes/compare/v1.2.4...v2.0.0">2.0.0</a> (2018-07-23)</p>
<h3 id="bug-fixes-11">Bug Fixes</h3>
<ul>
<li>“X” is not a valid hex prefix for char references (<a href="https://github.com/lddubeau/saxes/commit/465038b">465038b</a>)</li>
<li>add namespace checks (<a href="https://github.com/lddubeau/saxes/commit/9f94c4b">9f94c4b</a>)</li>
<li>always run in strict mode (<a href="https://github.com/lddubeau/saxes/commit/ed8b0b1">ed8b0b1</a>)</li>
<li>check that the characters we read are valid char data (<a href="https://github.com/lddubeau/saxes/commit/7611a85">7611a85</a>)</li>
<li>disallow spaces after open waka (<a href="https://github.com/lddubeau/saxes/commit/da7f76d">da7f76d</a>)</li>
<li>drop the lowercase option (<a href="https://github.com/lddubeau/saxes/commit/987d4bf">987d4bf</a>)</li>
<li>emit CDATA on empty CDATA section too (<a href="https://github.com/lddubeau/saxes/commit/95d192f">95d192f</a>)</li>
<li>emit empty comment (<a href="https://github.com/lddubeau/saxes/commit/b3db392">b3db392</a>)</li>
<li>entities are always strict (<a href="https://github.com/lddubeau/saxes/commit/0f6a30e">0f6a30e</a>)</li>
<li>fail on colon at start of QName (<a href="https://github.com/lddubeau/saxes/commit/507addd">507addd</a>)</li>
<li>harmonize error messages and initialize flags (<a href="https://github.com/lddubeau/saxes/commit/9a20cad">9a20cad</a>)</li>
<li>just one error for text before the root, and text after (<a href="https://github.com/lddubeau/saxes/commit/101ea50">101ea50</a>)</li>
<li>more namespace checks (<a href="https://github.com/lddubeau/saxes/commit/a1add21">a1add21</a>)</li>
<li>move namespace checks to their proper place (<a href="https://github.com/lddubeau/saxes/commit/4a1c99f">4a1c99f</a>)</li>
<li>only accept uppercase CDATA to mark the start of CDATA (<a href="https://github.com/lddubeau/saxes/commit/e86534d">e86534d</a>)</li>
<li>prevent colons in pi and entity names when xmlns is true (<a href="https://github.com/lddubeau/saxes/commit/4327eec">4327eec</a>)</li>
<li>prevent empty entities (<a href="https://github.com/lddubeau/saxes/commit/04e1593">04e1593</a>)</li>
<li>raise an error if the document does not have a root (<a href="https://github.com/lddubeau/saxes/commit/f2de520">f2de520</a>)</li>
<li>raise an error on ]]&gt; in character data (<a href="https://github.com/lddubeau/saxes/commit/2964381">2964381</a>)</li>
<li>raise an error on &lt; in attribute values (<a href="https://github.com/lddubeau/saxes/commit/4fd67a1">4fd67a1</a>)</li>
<li>raise an error on multiple root elements (<a href="https://github.com/lddubeau/saxes/commit/45047ae">45047ae</a>)</li>
<li>raise error on CDATA before or after root (<a href="https://github.com/lddubeau/saxes/commit/604241f">604241f</a>)</li>
<li>raise error on character reference outside CHAR production (<a href="https://github.com/lddubeau/saxes/commit/30fb540">30fb540</a>)</li>
<li>remove broken or pointless examples (<a href="https://github.com/lddubeau/saxes/commit/1a5b642">1a5b642</a>)</li>
<li>report an error on duplicate attributes (<a href="https://github.com/lddubeau/saxes/commit/ee4e340">ee4e340</a>)</li>
<li>report an error on whitespace at the start of end tag (<a href="https://github.com/lddubeau/saxes/commit/c13b122">c13b122</a>)</li>
<li>report processing instructions that do not have a target (<a href="https://github.com/lddubeau/saxes/commit/c007e39">c007e39</a>)</li>
<li>treat ?? in processing instructions correctly (<a href="https://github.com/lddubeau/saxes/commit/bc1e1d4">bc1e1d4</a>)</li>
<li>trim URIs (<a href="https://github.com/lddubeau/saxes/commit/78cc6f3">78cc6f3</a>)</li>
<li>use xmlchars for checking names (<a href="https://github.com/lddubeau/saxes/commit/2c939fe">2c939fe</a>)</li>
<li>verify that character references match the CHAR production (<a href="https://github.com/lddubeau/saxes/commit/369afde">369afde</a>)</li>
</ul>
<h3 id="code-refactoring">Code Refactoring</h3>
<ul>
<li>adjust the names used for processing instructions (<a href="https://github.com/lddubeau/saxes/commit/3b508e9">3b508e9</a>)</li>
<li>convert code to ES6 (<a href="https://github.com/lddubeau/saxes/commit/fe81170">fe81170</a>)</li>
<li>drop attribute event (<a href="https://github.com/lddubeau/saxes/commit/c7c2e80">c7c2e80</a>)</li>
<li>drop buffer size checks (<a href="https://github.com/lddubeau/saxes/commit/9ce2f7a">9ce2f7a</a>)</li>
<li>drop normalize (<a href="https://github.com/lddubeau/saxes/commit/9c6d84c">9c6d84c</a>)</li>
<li>drop opencdata and on closecdata (<a href="https://github.com/lddubeau/saxes/commit/3287d2c">3287d2c</a>)</li>
<li>drop SGML declaration parsing (<a href="https://github.com/lddubeau/saxes/commit/4aaf2d9">4aaf2d9</a>)</li>
<li>drop the <code>parser</code> function, rename SAXParser (<a href="https://github.com/lddubeau/saxes/commit/0878a6c">0878a6c</a>)</li>
<li>drop trim (<a href="https://github.com/lddubeau/saxes/commit/c03c7d0">c03c7d0</a>)</li>
<li>pass the actual tag to onclosetag (<a href="https://github.com/lddubeau/saxes/commit/7020e64">7020e64</a>)</li>
<li>provide default no-op implementation for events (<a href="https://github.com/lddubeau/saxes/commit/a94687f">a94687f</a>)</li>
<li>remove the API based on Stream (<a href="https://github.com/lddubeau/saxes/commit/ebb659a">ebb659a</a>)</li>
<li>simplify namespace processing (<a href="https://github.com/lddubeau/saxes/commit/2d4ce0f">2d4ce0f</a>)</li>
</ul>
<h3 id="features-3">Features</h3>
<ul>
<li>drop the resume() method; and have onerror() throw (<a href="https://github.com/lddubeau/saxes/commit/ac601e5">ac601e5</a>)</li>
<li>handle XML declarations (<a href="https://github.com/lddubeau/saxes/commit/5258939">5258939</a>)</li>
<li>revamped error messages (<a href="https://github.com/lddubeau/saxes/commit/cf9c589">cf9c589</a>)</li>
<li>the flush method returns its parser (<a href="https://github.com/lddubeau/saxes/commit/68c2020">68c2020</a>)</li>
</ul>
<h3 id="breaking-changes-1">BREAKING CHANGES</h3>
<ul>
<li>Sax was only passing the tag name. We pass the whole object.</li>
<li>The API no longer takes a <code>strict</code> argument anywhere. This also effectively removes support for HTML processing, or allow processing without errors anything which is less than full XML. It also removes special processing of <code>script</code> elements.</li>
<li><code>attribute</code> is not a particularly useful event for parsing XML. The only thing it adds over looking at attributes on tag objects is that you get the order of the attributes from the source, but attribute order in XML is irrelevant.</li>
<li>The opencdata and closecdata events became redundant once we removed the buffer size limitations. So we remove these events.</li>
<li>The <code>parser</code> function is removed. Just create a new instance with <code>new</code>.</li>
</ul>
<p><code>SAXParser</code> is now <code>SaxesParser.</code> So <code>new require("saxes").SaxesParser(...)</code>. * The API based on Stream is gone. There were multiple issues with it. It was Node-specific. It used an ancient Node API (the so-called “classic streams”). Its behavior was idiosyncratic. * Sax had no default error handler but if you wanted to continue calling <code>write()</code> after an error you had to call <code>resume()</code>. We do away with <code>resume()</code> and instead install a default <code>onerror</code> which throws. Replace with a no-op handler if you want to continue after errors. * The “processinginstruction” now produces a “target” field instead of a “name” field. The nomenclature “target” is the one used in the XML literature. * * The <code>ns</code> field is no longer using the prototype trick that sax used. The <code>ns</code> field of a tag contains only those namespaces that the tag declares.</p>
<ul>
<li>We no longer have <code>opennamespace</code> and <code>closenamespace</code> events. The information they provide can be obtained by examining the tags passed to tag events.</li>
<li>SGML declaration is not supported by XML. This is an XML parser. So we remove support for SGML declarations. They now cause errors.</li>
<li>We removed support for the code that checked buffer sizes and would raise errors if a buffer was close to an arbitrary limit or emitted multiple <code>text</code> or <code>cdata</code> events in order avoid passing strings greater than an arbitrary size. So <code>MAX_BUFFER_LENGTH</code> is gone.</li>
</ul>
<p>The feature always seemed a bit awkward. Client code could limit the size of buffers to 1024K, for instance, and not get a <code>text</code> event with a text payload greater than 1024K… so far so good but if the same document contained a comment with more than 1024K that would result in an error. Hmm…. why? The distinction seems entirely arbitrary.</p>
<p>The upshot is that client code needs to be ready to handle strings of any length supported by the platform.</p>
<p>If there’s a clear need to reintroduce it, we’ll reassess. * It is no longer possible to load the library as-is through a <code>script</code> element. It needs building.</p>
<p>The library now assumes a modern runtime. It no longer contains any code to polyfill what’s missing. It is up to developers using this code to deal with polyfills as needed. * We drop the <code>trim</code> option. It is up to client code to trip text if it needs it. * We no longer support the <code>normalize</code> option. It is up to client code to perform whatever normalization it wants. * The <code>lowercase</code> option makes no sense for XML. It is removed. * Remove support for strictEntities. Entities are now always strict, as required by the XML specification. * By default parsers now have a default no-op implementation for each event it supports. This would break code that determines whether a custom handler was added by checking whether there’s any handler at all. This removes the necessity for the parser implementation to check whether there is a handler before calling it.</p>
<p>In the process of making this change, we’ve removed support for the <code>on...</code> properties on streams objects. Their existence was not warranted by any standard API provided by Node. (<code>EventEmitter</code> does not have <code>on...</code> properties for events it supports, nor does <code>Stream</code>.) Their existence was also undocumented. And their functioning was awkward. For instance, with sax, this:</p>
<pre><code>const s = sax.createStream();
const handler = () =&gt; console.log(&quot;moo&quot;);
s.on(&quot;cdata&quot;, handler);
console.log(s.oncdata === handler);</code></pre>
<p>would print <code>false</code>. If you examine <code>s.oncdata</code> you see it is glue code instead of the handler assigned. This is just bizarre, so we removed it.</p>
</body>
</html>
